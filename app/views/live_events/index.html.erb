<!-- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ« -->
<div class="row align-items-center mb-4 fade-in">
  <div class="col">
    <h1 class="display-5 fw-bold text-primary mb-2 title-hover">
      <i class="fas fa-search me-3 icon-pulse"></i>ãƒ©ã‚¤ãƒ–æ¤œç´¢
    </h1>
    <p class="lead text-muted slide-in">å…¨å›½ã®ãƒ©ã‚¤ãƒ–ãƒ»ã‚³ãƒ³ã‚µãƒ¼ãƒˆæƒ…å ±ã‚’ãƒã‚§ãƒƒã‚¯ã—ã‚ˆã†ï¼</p>
  </div>
</div>

<style>
  /* åŸºæœ¬ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  .fade-in {
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards;
  }
  
  .slide-in {
    opacity: 0;
    transform: translateX(-30px);
    animation: slideInLeft 1s ease 0.3s forwards;
  }
  
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes slideInLeft {
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  /* ãƒ›ãƒãƒ¼åŠ¹æœ */
  .title-hover:hover {
    transform: scale(1.02);
    transition: all 0.3s ease;
    text-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
  }
  
  /* ã‚¢ã‚¤ã‚³ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  .icon-pulse {
    animation: iconPulse 2s infinite;
  }
  
  @keyframes iconPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
  }
  
  /* ã‚«ãƒ¼ãƒ‰ãƒ›ãƒãƒ¼åŠ¹æœ */
  .hover-card {
    transition: all 0.3s ease;
  }
  
  .hover-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.15) !important;
  }
  
  /* æ¤œç´¢ã‚«ãƒ¼ãƒ‰ã®ãƒ›ãƒãƒ¼ */
  .search-card:hover {
    transform: translateY(-3px);
    transition: all 0.3s ease;
  }
  
  /* ãƒœã‚¿ãƒ³ã®ãƒ›ãƒãƒ¼åŠ¹æœ */
  .btn:hover {
    transform: translateY(-2px);
    transition: all 0.3s ease;
  }
  
  /* ã‚¢ã‚¤ã‚³ãƒ³ã®å€‹åˆ¥ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  .icon-rotate:hover {
    transform: rotateY(360deg);
    transition: transform 0.6s ease;
  }
  
  .icon-bounce:hover {
    animation: iconBounce 0.6s ease;
  }
  
  @keyframes iconBounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
  }
  
  /* ãƒãƒƒã‚¸ã®ãƒ‘ãƒ«ã‚¹ */
  .badge {
    animation: badgePulse 3s infinite;
  }
  
  @keyframes badgePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
</style>

<div class="alert alert-success">
  ğŸ‰ è¤‡æ•°ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸï¼å„è¦ç´ ã«ãƒã‚¦ã‚¹ã‚’è¼‰ã›ã¦ã¿ã¦ãã ã•ã„ã€‚
</div>

<!-- æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="card shadow-sm mb-4 search-card">
  <div class="card-body">
    <%= form_with url: live_events_path, method: :get, local: true, class: "search-form" do |form| %>
      <div class="row g-3 align-items-end">
        <div class="col-md-4">
          <label class="form-label fw-semibold">
            <i class="fas fa-search me-1 icon-rotate"></i>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
          </label>
          <%= form.text_field :search,
              value: params[:search],
              placeholder: "ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã€ãƒ©ã‚¤ãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã€ä¼šå ´å...",
              class: "form-control form-control-lg" %>
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">
            <i class="fas fa-map-marker-alt me-1 icon-bounce"></i>éƒ½é“åºœçœŒ
          </label>
          <%= form.select :prefecture,
              options_for_select([
                ['å…¨ã¦ã®éƒ½é“åºœçœŒ', ''],
                ['æ±äº¬éƒ½', 'æ±äº¬éƒ½'], ['å¤§é˜ªåºœ', 'å¤§é˜ªåºœ'], ['ç¥å¥ˆå·çœŒ', 'ç¥å¥ˆå·çœŒ'],
                ['æ„›çŸ¥çœŒ', 'æ„›çŸ¥çœŒ'], ['ç¦å²¡çœŒ', 'ç¦å²¡çœŒ'], ['åŒ—æµ·é“', 'åŒ—æµ·é“'],
                ['å®®åŸçœŒ', 'å®®åŸçœŒ'], ['åŸ¼ç‰çœŒ', 'åŸ¼ç‰çœŒ'], ['åƒè‘‰çœŒ', 'åƒè‘‰çœŒ'],
                ['å…µåº«çœŒ', 'å…µåº«çœŒ'], ['äº¬éƒ½åºœ', 'äº¬éƒ½åºœ'], ['åºƒå³¶çœŒ', 'åºƒå³¶çœŒ']
              ], params[:prefecture]),
              {},
              { class: "form-select form-select-lg" } %>
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">
            <i class="fas fa-calendar me-1 icon-bounce"></i>é–‹å‚¬æ—¥
          </label>
          <div class="input-group">
            <%= form.date_field :date_from, value: params[:date_from], class: "form-control" %>
            <span class="input-group-text">ã€œ</span>
            <%= form.date_field :date_to, value: params[:date_to], class: "form-control" %>
          </div>
        </div>

        <div class="col-md-2">
          <div class="d-grid gap-2">
            <%= form.submit "ğŸ” æ¤œç´¢", class: "btn btn-gradient btn-lg" %>
            <%= link_to "ã‚¯ãƒªã‚¢", live_events_path, class: "btn btn-outline-secondary" %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<!-- ãƒ©ã‚¤ãƒ–ä¸€è¦§ -->
<div class="row">
  <% if @live_events.any? %>
    <% @live_events.each do |live_event| %>
      <div class="col-lg-6 mb-4">
        <div class="card h-100 shadow-sm hover-card">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <h5 class="card-title text-primary mb-0">
                <%= link_to live_event.title, live_event_path(live_event), 
                    class: "text-decoration-none text-primary" %>
              </h5>
              <span class="badge bg-primary"><%= live_event.prefecture %></span>
            </div>

            <div class="mb-3">
              <p class="mb-2 text-dark">
                <i class="fas fa-microphone-alt text-primary me-2 icon-rotate"></i>
                <strong><%= live_event.artist %></strong>
              </p>
              <p class="mb-2 text-muted">
                <i class="fas fa-map-marker-alt text-primary me-2 icon-bounce"></i>
                <%= live_event.venue %>
              </p>
              <p class="mb-2 text-muted">
                <i class="fas fa-calendar-alt text-primary me-2 icon-bounce"></i>
                <%= live_event.date.strftime("%Yå¹´%mæœˆ%dæ—¥ %H:%M") if live_event.date %>
              </p>
              <% if live_event.price %>
                <p class="mb-2 text-success fw-bold">
                  <i class="fas fa-yen-sign text-primary me-2 icon-rotate"></i>
                  Â¥<%= number_with_delimiter(live_event.price) %>
                </p>
              <% end %>
            </div>

            <% if live_event.description.present? %>
              <p class="card-text text-muted small mb-3">
                <%= truncate(live_event.description, length: 80) %>
              </p>
            <% end %>

            <div class="d-flex justify-content-between align-items-center">
              <!-- ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ -->
              <div class="favorite-section">
                <% if current_user %>
                  <% if current_user.favorited?(live_event) %>
                    <%= button_to unfavorite_live_event_path(live_event),
                                  method: :delete,
                                  class: "btn btn-outline-danger btn-sm",
                                  title: "ãŠæ°—ã«å…¥ã‚Šã‹ã‚‰å‰Šé™¤" do %>
                      <i class="fas fa-heart me-1"></i>
                      <span class="badge bg-danger"><%= live_event.favorites.count %></span>
                    <% end %>
                  <% else %>
                    <%= button_to favorite_live_event_path(live_event),
                                  method: :post,
                                  class: "btn btn-outline-primary btn-sm",
                                  title: "ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ " do %>
                      <i class="far fa-heart me-1"></i>
                      <span class="badge bg-primary"><%= live_event.favorites.count %></span>
                    <% end %>
                  <% end %>
                <% else %>
                  <%= link_to login_path, class: "btn btn-outline-secondary btn-sm", 
                      title: "ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãŠæ°—ã«å…¥ã‚Šç™»éŒ²" do %>
                    <i class="far fa-heart me-1"></i>
                    <span class="badge bg-secondary">0</span>
                  <% end %>
                <% end %>
              </div>

              <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
              <div class="btn-group">
                <%= link_to "è©³ç´°", live_event_path(live_event), 
                    class: "btn btn-outline-primary btn-sm" %>
                <% if live_event.ticket_url.present? %>
                  <%= link_to "ãƒã‚±ãƒƒãƒˆ", live_event.ticket_url, target: "_blank", 
                      class: "btn btn-success btn-sm" %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <div class="col-12">
      <div class="text-center py-5">
        <i class="fas fa-music text-muted mb-3" style="font-size: 4rem;"></i>
        <h3 class="text-muted">ãƒ©ã‚¤ãƒ–æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
        <p class="text-muted mb-4">æ¤œç´¢æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã‹ã€æ–°ã—ã„ãƒ©ã‚¤ãƒ–æƒ…å ±ã‚’è¿½åŠ ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>
        <%= link_to "ãƒ©ã‚¤ãƒ–ã‚’è¿½åŠ ã™ã‚‹", new_live_event_path, class: "btn btn-gradient btn-lg" %>
      </div>
    </div>
  <% end %>
</div>
